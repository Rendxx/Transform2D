{"version":3,"sources":["Transform2D.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Transform2D.js","sourcesContent":["/************************************************ \r\n \r\nTransform 2D\r\nCopyright (c) 2014-2015 Dongxu Ren  http://www.rendxx.com/\r\n \r\nLicense: MIT (http://www.opensource.org/licenses/mit-license.php)\r\nVersion: 0.4.0\r\nUpdate: 2015-10-16\r\n\r\nDescription:\r\n   A simple way to implement CSS3 2D transform. Works in CSS2 as well. \r\n   Available transformation includes: rotation, scale, translate.\r\n\r\n   Each transformation is considered as an independent event, which mean multiple transformations will not affect each other.\r\n   The order of transformstion in CSS3 is Translate -> Rotate -> Scale.\r\n\r\n   This library supports IE 7-8 as well. Margin attribute is used to handle offset in this case. DO NOT change margin after applying transform in IE7-8\r\n      \r\nCompatibility:\r\n    Chrome; Fire Fox; Safari; Edge; IE 9-11; IE 7,8;\r\n\r\nDependency:\r\n   jQuery\r\n\r\nAPI:\r\n  Get 2D Transform data:\r\n    [jQuery Element].rotate();\r\n    - (number) get rotation of the element (in deg)\r\n\r\n    [jQuery Element].scale();\r\n    - ([number, number]) get scale ratio of the element (in [Scale X, Scale Y])\r\n\r\n    [jQuery Element].translate();\r\n    - ([number, number]) get translate of the element(in [Translate X, Translate Y])\r\n     \r\n    \r\n    [jQuery Element].transform2D();\r\n    - (object) get all transform2D of the element\r\n    - returned object data:\r\n        {\r\n            rotate: (number)\r\n            scaleX: (number)\r\n            scaleY: (number)\r\n            translateX: (number)\r\n            translateY: (number)\r\n        }\r\n        \r\n\r\n  Set 2D Transform:\r\n    Note: For all arguments, \"+=\" and \"-=\" at the head of an option mean add/minus given value based on current value, otherwise mean transform to that specific situation.\r\n\r\n    [jQuery Element].rotate(deg);\r\n    - Rotate the element clockwise\r\n    - Arguments:\r\n        deg: rotate the given degree, positive value means clockwise (number/string)\r\n\r\n    [jQuery Element].scaleX(ratio);\r\n    - Scale the element in X by the given ratio\r\n    - Arguments:\r\n        ratio: scale in x-axis (number/string)\r\n    \r\n    [jQuery Element].scaleY(ratio);\r\n    - Scale the element in Y by the given ratio\r\n    - Arguments:\r\n        ratio: scale in y-axis (number/string)\r\n\r\n    [jQuery Element].scale(ratio);\r\n    - Scale the element in both X and Y by the given ratio\r\n    - Arguments:\r\n        ratio: scale in both x-axis and y-axis (number/string)\r\n\r\n    [jQuery Element].scale(ratioArr);\r\n    - Scale the element in  X and Y separately\r\n    - Arguments:\r\n        ratioArr: [ratioX, ratioY]\r\n     \r\n    [jQuery Element].translateX(offset);\r\n    - Offset the element in X\r\n    - Arguments:\r\n        offset: offset in x-axis, positive value means right (number/string)\r\n     \r\n    [jQuery Element].translateY(offset);\r\n    - Offset the element in Y\r\n    - Arguments:\r\n        offset: offset in y-axis, positive value means bottom (number/string)\r\n     \r\n    [jQuery Element].translate(offsetArr);\r\n    - Offset the element in X and Y separately\r\n    - Arguments:\r\n        offsetArr: [offsetX,offsetY]\r\n\r\n    [jQuery Element].transform2D(opts);\r\n    - transform the element by given option\r\n    - Arguments:\r\n        opts\r\n            {\r\n                rotate: (number/string)\r\n                scaleX: (number/string)\r\n                scaleY: (number/string)\r\n                translateX: (number/string)\r\n                translateY: (number/string)\r\n            }\r\n************************************************/\r\n(function ($) {\r\n    \"use strict\";\r\n    // Private Function -----------------------------------------------\r\n    var keyName = \"Rtransform2D\";\r\n    var isOldIE = null;\r\n    var detectOldIE = function (ele) {\r\n        var detect = $('<!--[if lt IE 7]><div class=\"ieDetect ie6\"> <![endif]-->' +\r\n          '<!--[if IE 7]><div class=\"ieDetect ie7\"> <![endif]-->' +\r\n          '<!--[if IE 8]><div class=\"ieDetect ie8\"> <![endif]-->' +\r\n          '<!--[if gt IE 8]><!--><div class=\"ieDetect yes\"><!--<![endif]-->' +\r\n          '</div>');\r\n        detect.appendTo($(\"body\"));\r\n        if ($('.ieDetect').hasClass('yes')) {\r\n            detect.remove();\r\n            return false;\r\n        }\r\n        detect.remove();\r\n        return true;\r\n    };\r\n\r\n    var getMatrix = function (ele) {\r\n        var matrix = ele.css(\"-webkit-transform\") ||\r\n            ele.css(\"-moz-transform\") ||\r\n            ele.css(\"-ms-transform\") ||\r\n            ele.css(\"-o-transform\") ||\r\n            ele.css(\"transform\") ||\r\n            \"none\";\r\n        //console.log(matrix);\r\n        if (matrix === \"none\") {\r\n            // Deal with IE\r\n            matrix = ele.css(\"-ms-filter\") ||\r\n                ele.css(\"filter\") ||\r\n                \"none\";\r\n            if (matrix === \"none\" || matrix.indexOf(\"DXImageTransform.Microsoft.Matrix\") < 0) return [1, 0, 0, 1, 0, 0];\r\n            matrix = matrix.split('(')[1].split(')')[0].split(',');\r\n            var matrix2 = [];\r\n            matrix2[0] = matrix[0].split('=')[1];\r\n            matrix2[1] = matrix[2].split('=')[1];\r\n            matrix2[2] = matrix[1].split('=')[1];\r\n            matrix2[3] = matrix[3].split('=')[1];\r\n            matrix2[4] = 0;\r\n            matrix2[5] = 0;\r\n\r\n            return matrix2;\r\n        }\r\n        return matrix.split('(')[1].split(')')[0].split(',');\r\n    };\r\n\r\n    var matrixMult = function (m1, m2) {\r\n        m = [0, 0, 0, 0, 0, 0];\r\n        m[0] = m1[0] * m2[0] + m1[2] * m2[1];\r\n        m[1] = m1[1] * m2[0] + m1[3] * m2[1];\r\n        m[2] = m1[0] * m2[2] + m1[2] * m2[3];\r\n        m[3] = m1[1] * m2[2] + m1[3] * m2[3];\r\n        m[4] = m1[0] * m2[4] + m1[2] * m2[5] + m1[4];\r\n        m[5] = m1[1] * m2[4] + m1[3] * m2[5] + m1[5];\r\n        return m;\r\n    };\r\n    var getRotate = function (ele) {\r\n        var angle = 0;\r\n        var matrix = getMatrix(ele);\r\n        if (matrix != null) {\r\n            var a = matrix[0];\r\n            var b = matrix[1];\r\n            angle = Math.round(Math.atan2(b, a) * (180 / Math.PI));\r\n        } else {\r\n            angle = 0;\r\n        }\r\n        return (angle < 0) ? angle += 360 : angle;\r\n    };\r\n    var getScale = function (ele) {\r\n        var matrix = getMatrix(ele);\r\n        var rst = [1, 1];\r\n        if (matrix == null) return rst;\r\n        rst[0] = Math.sqrt(matrix[0] * matrix[0] + matrix[1] * matrix[1]);\r\n        rst[1] = Math.sqrt(matrix[2] * matrix[2] + matrix[3] * matrix[3]);\r\n        return rst;\r\n    };\r\n    var getTranslate = function (ele) {\r\n        if (isOldIE) {\r\n            var para = ele.data(keyName);\r\n            if (para != null)\r\n                return [Number(para.translateX), Number(para.translateY)];\r\n            else\r\n                return [0, 0];\r\n        }\r\n        var matrix = getMatrix(ele);\r\n        return [Number(matrix[4]), Number(matrix[5])];\r\n    };\r\n\r\n    // API ------------------------------------------------------------\r\n    // Get/Set Rotation\r\n    $.fn.rotate = function (deg) {\r\n        if (deg == null) return getRotate($(this));\r\n        $(this).transform2D({\r\n            rotate: deg\r\n        });\r\n    };\r\n\r\n    // Get/Set Scale\r\n    $.fn.scale = function (ratio) {\r\n        if (ratio == null) return getScale($(this));\r\n        if (typeof ratio == 'object')\r\n            $(this).transform2D({\r\n                scaleX: ratio[0],\r\n                scaleY: ratio[1]\r\n            });\r\n        else\r\n            $(this).transform2D({\r\n                scaleX: ratio,\r\n                scaleY: ratio\r\n            });\r\n    };\r\n\r\n    // Get/Set Scale X\r\n    $.fn.scaleX = function (ratio) {\r\n        if (ratio == null) return getScale($(this))[0];\r\n        $(this).transform2D({\r\n            scaleX: ratio\r\n        });\r\n    };\r\n\r\n    // Get/Set Scale Y\r\n    $.fn.scaleY = function (ratio) {\r\n        if (ratio == null) return getScale($(this))[1];\r\n        $(this).transform2D({\r\n            scaleY: ratio\r\n        });\r\n    };\r\n\r\n    // Get/Set Translate\r\n    $.fn.translate = function (offset) {\r\n        if (offset == null) return getTranslate($(this));\r\n        if (typeof offset == 'object')\r\n            $(this).transform2D({\r\n                translateX: offset[0],\r\n                translateY: offset[1]\r\n            });\r\n        else\r\n            $(this).transform2D({\r\n                translateX: offset,\r\n                translateY: offset\r\n            });\r\n    };\r\n\r\n    // Get/Set Translate X\r\n    $.fn.translateX = function (offset) {\r\n        if (offset == null) return getTranslate($(this))[0];\r\n        $(this).transform2D({\r\n            translateX: offset\r\n        });\r\n    };\r\n\r\n    // Get/Set Translate Y\r\n    $.fn.translateY = function (offset) {\r\n        if (offset == null) return getTranslate($(this))[1];\r\n        $(this).transform2D({\r\n            translateY: offset\r\n        });\r\n    };\r\n\r\n    // parse the option to processed \r\n    // processed data: [mark, value]\r\n    // mark: true: equal to,  false:add\r\n    var _parseOpts = function (options) {\r\n        // get opts based on current transform data\r\n        var input;\r\n        var tmp;\r\n        var operationIdx = -1;\r\n        var opts = {};\r\n\r\n        for (var i in options) {\r\n            if (options.hasOwnProperty(i) && options[i] != null) {\r\n                input = options[i];\r\n                if (typeof input == \"string\") {\r\n                    operationIdx = input.indexOf(\"+=\");\r\n                    if (operationIdx != -1) {\r\n                        input = parseFloat(input.substring(operationIdx + 2));\r\n                        if (input == input) opts[i] = [false, input];\r\n                        continue;\r\n                    }\r\n\r\n                    operationIdx = input.indexOf(\"-=\");\r\n                    if (operationIdx != -1) {\r\n                        input = -parseFloat(input.substring(operationIdx + 2));\r\n                        if (input == input) opts[i] = [false, input];\r\n                        continue;\r\n                    }\r\n\r\n                    input = parseFloat(input);\r\n                    if (input == input) opts[i] = [true, input];\r\n                } else if (typeof input == \"number\") {\r\n                    opts[i] = [true, input];\r\n                }\r\n            }\r\n        }\r\n\r\n        return opts;\r\n    };\r\n\r\n    // get the transform information from given options\r\n    var _getTransform = function (transform, ele) {\r\n        // get opts based on current transform data\r\n        var tmp;\r\n        var operationIdx = -1;\r\n\r\n        var opts = ele.transform2D();\r\n        for (var i in transform) {\r\n            if (transform.hasOwnProperty(i)) {\r\n                if (transform[i][0]) opts[i] = transform[i][1];\r\n                else opts[i] += transform[i][1];\r\n            }\r\n        }\r\n\r\n        return opts;\r\n    };\r\n\r\n    // Set Css3 2D transform\r\n    // Sequence:  Translate > Scale > Rotate\r\n    // Get(if no input arguement) return: Translate information.\r\n    $.fn.transform2D = function (options) {\r\n        if (isOldIE == null) isOldIE = detectOldIE();\r\n        if (options == null) {\r\n            // get all transform data\r\n            var scaleData = this.scale();\r\n            var translateData = this.translate();\r\n            return {\r\n                rotate: this.rotate(),\r\n                scaleX: scaleData[0],\r\n                scaleY: scaleData[1],\r\n                translateX: translateData[0],\r\n                translateY: translateData[1]\r\n            };\r\n        } else {\r\n            options = _parseOpts(options);\r\n            // set all transform data\r\n            this.each(function () {\r\n                var $this = $(this);\r\n                options = _getTransform(options, $this);\r\n\r\n                // handle transform\r\n                if (!isOldIE) {\r\n                    // Use Css 3 for modern browser\r\n                    //var m_str = \"matrix(\" + m[0] + \",\" + m[2] + \",\" + m[1] + \",\" + m[3] + \",\" + m[4] + \",\" + m[5] + \")\";\r\n                    var m_str =\r\n                        \"translateX(\" + options.translateX + \"px) \" +\r\n                        \"translateY(\" + options.translateY + \"px) \"+\r\n                        \"rotate(\" + options.rotate + \"deg) \"+\r\n                        \"scaleX(\" + options.scaleX + \") \" +\r\n                        \"scaleY(\" + options.scaleY + \") \";\r\n\r\n                    $this.css(\"-ms-transform\", m_str);\r\n                    $this.css(\"-webkit-transform\", m_str);\r\n                    $this.css(\"transform\", m_str);\r\n\r\n                } else {\r\n                    // For IE 7 8\r\n                    var radians = (options.rotate % 360) * (Math.PI / 180);\r\n                    var m2 = matrixMult([Math.cos(radians), Math.sin(radians), -1 * Math.sin(radians), Math.cos(radians), 0, 0], [options.scaleX, 0, 0, options.scaleY, options.translateX, options.translateY]);\r\n                    var m = [];\r\n                    for (var i = 0; i < 6; i++) {\r\n                        m[i] = String(m2[i]);\r\n                        if (m[i].indexOf(\".\") == -1) m[i] += \".0\";\r\n                    }\r\n                    // store original data\r\n                    var para = $this.data(keyName);\r\n                    var marginTop = 0;\r\n                    var marginLeft = 0;\r\n                    \r\n                    $this.css(\"-ms-filter\", \"\");\r\n                    $this.css(\"filter\", \"\");\r\n\r\n                    marginTop = parseInt($this.css('margin-top'));\r\n                    if (marginTop != marginTop) marginTop = 0;\r\n                    marginLeft = parseInt($this.css('margin-left'));\r\n                    if (marginLeft != marginLeft) marginLeft = 0;\r\n\r\n                    if (para != null) {\r\n                        marginTop -= para.marginTop;\r\n                        marginLeft -= para.marginLeft;\r\n                    };\r\n\r\n                    var original_w = $this.width();\r\n                    var original_h = $this.height();\r\n\r\n                    var m_str_ie = \"progid:DXImageTransform.Microsoft.Matrix(M11=\" + m[0] + \", M12=\" + m[2] + \", M21=\" + m[1] + \", M22=\" + m[3] + \", SizingMethod='auto expand')\";\r\n                    $this.css(\"-ms-filter\", m_str_ie);\r\n                    $this.css(\"filter\", m_str_ie);\r\n                    var w2 = $this.width();\r\n                    var h2 = $this.height();\r\n                    var offset_w = (w2 - original_w) / 2;\r\n                    var offset_h = (h2 - original_h) / 2;\r\n\r\n                    para = {\r\n                        translateX: options.translateX,\r\n                        translateY: options.translateY,\r\n                        marginTop: options.translateY - offset_h,\r\n                        marginLeft: options.translateX - offset_w\r\n                    };\r\n\r\n                    $this.css(\"margin-left\", (para.marginLeft + marginLeft) + \"px\");\r\n                    $this.css(\"margin-top\", (para.marginTop + marginTop) + \"px\");\r\n\r\n                    $this.data(keyName, para);\r\n                }\r\n            });\r\n            return this;\r\n        }\r\n    };\r\n})(jQuery);"],"sourceRoot":"/source/"}